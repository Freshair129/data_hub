# ============================================================================
# V School CRM â€” ID Mapping & Relationship Reference
# ============================================================================
# à¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰à¹ƒà¸Šà¹‰à¹€à¸›à¹‡à¸™ Single Source of Truth à¸ªà¸³à¸«à¸£à¸±à¸š ID à¸—à¸¸à¸à¸•à¸±à¸§à¹ƒà¸™à¸£à¸°à¸šà¸š
# à¸­à¸±à¸›à¹€à¸”à¸•à¸¥à¹ˆà¸²à¸ªà¸¸à¸”: 2026-03-01
#
# à¸ªà¸–à¸²à¸™à¸°:
#   âœ… linked      = à¸œà¸¹à¸ FK / index à¹à¸¥à¹‰à¸§ à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹„à¸”à¹‰
#   âš ï¸ string      = à¸œà¸¹à¸à¸”à¹‰à¸§à¸¢à¸Šà¸·à¹ˆà¸­ (string match) à¹„à¸¡à¹ˆà¸¡à¸µ FK à¸ˆà¸£à¸´à¸‡
#   âŒ missing     = à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ à¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸«à¸¡à¹ˆ
#   ğŸ”² proposed    = à¹€à¸ªà¸™à¸­à¹€à¸à¸´à¹ˆà¸¡ (à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ)
#   ğŸ—‘ï¸ deprecated  = à¸¥à¸šà¸­à¸­à¸ â€” à¸£à¸°à¸šà¸¸à¹€à¸«à¸•à¸¸à¸œà¸¥
#
# â”€â”€â”€ ARCHITECTURE DECISION (2026-03-01) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Agent = Employee (à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¹à¸¥à¹‰à¸§)
#
# Admin à¸—à¸µà¹ˆà¸•à¸­à¸šà¹à¸Šà¸— Facebook à¸„à¸·à¸­ Employee à¸„à¸™à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™
# à¸”à¸±à¸‡à¸™à¸±à¹‰à¸™ FK à¸—à¸¸à¸à¸•à¸±à¸§à¹ƒà¸™à¸£à¸°à¸šà¸šà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸š "à¹ƒà¸„à¸£à¸—à¸³à¸­à¸°à¹„à¸£" à¸Šà¸µà¹‰à¹„à¸› Employee.id à¹‚à¸”à¸¢à¸•à¸£à¸‡
#
#   Message.responderId      â†’ Employee.id  (à¹ƒà¸„à¸£à¸•à¸­à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸™à¸µà¹‰)
#   Conversation.assignedAgentId â†’ Employee.id  (à¹ƒà¸„à¸£à¸£à¸±à¸šà¸œà¸´à¸”à¸Šà¸­à¸šà¹à¸Šà¸—à¸™à¸µà¹‰)
#   Order.closedById         â†’ Employee.id  (à¹ƒà¸„à¸£à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢)
#   Task.assigneeId          â†’ Employee.id  âœ… à¸¡à¸µà¹à¸¥à¹‰à¸§
#
# Employee.agentId â†’ ğŸ—‘ï¸ DEPRECATED â€” dead field, à¹„à¸¡à¹ˆà¸¡à¸µ FK à¹ƒà¸”à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡
#                    à¹ƒà¸Šà¹‰ Employee.id à¹à¸—à¸™à¹‚à¸”à¸¢à¸•à¸£à¸‡
#
# â”€â”€â”€ AI CHAT BAR (per page) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# à¹à¸•à¹ˆà¸¥à¸°à¸«à¸™à¹‰à¸²à¹ƒà¸™ CRM à¸¡à¸µ AI chat bar à¸—à¸µà¹ˆà¹‚à¸«à¸¥à¸” context à¹€à¸‰à¸à¸²à¸°à¸‚à¸­à¸‡à¸«à¸™à¹‰à¸²à¸™à¸±à¹‰à¸™
# à¹‚à¸”à¸¢à¸œà¸¹à¸à¸à¸±à¸š Employee.id à¸‚à¸­à¸‡ admin à¸—à¸µà¹ˆ login à¸­à¸¢à¸¹à¹ˆ
# à¸”à¸¹à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹ƒà¸™ Section 9 (AI_CONTEXT)
# ============================================================================

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 1. IDENTITY â€” à¸•à¸±à¸§à¸•à¸™à¸‚à¸­à¸‡à¸„à¸™à¹ƒà¸™à¸£à¸°à¸šà¸š
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

identity:

  customer:
    table: customers
    primary_id:
      field: customerId
      format: "TVS-CUS-[CH]-[YY]-[XXXX]"
      example: "TVS-CUS-FB-26-0123"
      status: âœ… linked
      note: "unique, à¹ƒà¸Šà¹‰à¸—à¸±à¹ˆà¸§à¸£à¸°à¸šà¸š"

    psid:
      field: facebookId / participantId
      format: "numeric string (Page-Scoped ID)"
      example: "25570885055945173"
      status: âœ… linked
      note: >
        ID à¸¥à¸¹à¸à¸„à¹‰à¸² "à¹€à¸‰à¸à¸²à¸°à¹€à¸à¸ˆà¸™à¸µà¹‰" â€” à¸–à¹‰à¸²à¸„à¸™à¹€à¸”à¸´à¸¡à¸—à¸±à¸à¹€à¸à¸ˆà¸­à¸·à¹ˆà¸™ à¹€à¸¥à¸‚à¸ˆà¸°à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
        à¹ƒà¸™à¸£à¸°à¸šà¸šà¹€à¸£à¸²à¹ƒà¸Šà¹‰à¸•à¸±à¸§à¸™à¸µà¹‰à¹€à¸›à¹‡à¸™ Primary Key à¸ªà¸³à¸«à¸£à¸±à¸šà¸œà¸¹à¸ Customer Profile 
        (à¹€à¸à¹‡à¸šà¹ƒà¸™ Customer.facebookId à¹à¸¥à¸° Conversation.participantId)

    business_scoped_id:
      field: "(à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸à¹‡à¸š)"
      format: "numeric string"
      status: ğŸ”² proposed
      note: >
        ID à¸¥à¸¹à¸à¸„à¹‰à¸²à¸—à¸µà¹ˆ "à¸„à¸‡à¸—à¸µà¹ˆ" à¸ªà¸³à¸«à¸£à¸±à¸šà¸—à¸¸à¸à¹€à¸à¸ˆà¸ à¸²à¸¢à¹ƒà¸•à¹‰ Business Manager à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™
        à¸„à¸·à¸­à¸•à¸±à¸§à¸—à¸µà¹ˆà¸šà¸­à¸ªà¸ˆà¸³à¹„à¸”à¹‰à¸§à¹ˆà¸²à¹„à¸›à¸—à¸µà¹ˆà¹„à¸«à¸™à¸à¹‡à¹ƒà¸Šà¹‰à¸­à¸±à¸™à¹€à¸”à¸´à¸¡ â€” à¸•à¹‰à¸­à¸‡à¸‚à¸­à¸œà¹ˆà¸²à¸™ Graph API 
        (endpoint: ids_for_business) à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸Šà¹‰à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¹‚à¸¢à¸‡à¸¥à¸¹à¸à¸„à¹‰à¸²à¸‚à¹‰à¸²à¸¡à¹€à¸à¸ˆ

    linked_to:
      - { target: conversations, via: "customerId FK", status: "âœ… linked" }
      - { target: orders,        via: "customerId FK", status: "âœ… linked" }
      - { target: tasks,         via: "customerId FK", status: "âœ… linked" }
      - { target: timeline,      via: "customerId FK", status: "âœ… linked" }
      - { target: inventory,     via: "customerId FK", status: "âœ… linked" }
      - { target: cart,          via: "customerId FK", status: "âœ… linked" }

  employee:
    table: employees
    primary_id:
      field: employeeId
      format: "TVS-EMP-[XXX]"
      example: "TVS-EMP-001"
      status: âœ… linked
      note: "unique"

    agent_id:
      field: agentId
      status: ğŸ—‘ï¸ deprecated
      decision_date: "2026-03-01"
      reason: >
        Dead field â€” à¹„à¸¡à¹ˆà¸¡à¸µ business logic à¹ƒà¸Šà¹‰à¹€à¸¥à¸¢ à¹„à¸¡à¹ˆà¸¡à¸µ model FK à¸¡à¸²à¸«à¸²
        Agent = Employee (à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¹à¸¥à¹‰à¸§) à¹ƒà¸Šà¹‰ Employee.id à¹‚à¸”à¸¢à¸•à¸£à¸‡à¹à¸—à¸™
        à¸¥à¸šà¸­à¸­à¸à¸ˆà¸²à¸ schema à¹ƒà¸™ migration à¸–à¸±à¸”à¹„à¸›

    facebook_name:
      field: facebookName
      format: "string"
      example: "Satabongkot Noinin"
      status: âš ï¸ string
      note: "à¹ƒà¸Šà¹‰ fuzzy match à¹ƒà¸™ TeamKPI â€” à¸Šà¸·à¹ˆà¸­à¸ˆà¸²à¸ FB Business Suite"

    linked_to:
      - { target: tasks, via: "assigneeId FK", status: "âœ… linked" }
      - { target: messages, via: "responderId FK", status: "âœ… linked" }
      - { target: conversations, via: "assignedEmployeeId FK", status: "âœ… linked" }

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 2. CONVERSATION â€” à¹à¸Šà¸—à¹à¸¥à¸°à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

conversation:

  conversation:
    table: conversations
    primary_id:
      field: conversationId
      format: "t_XXXXXXXX"
      example: "t_7891011121314"
      source: "Facebook Graph API"
      status: âœ… linked

    assigned_agent:
      field: assignedAgent
      format: "string (à¸Šà¸·à¹ˆà¸­à¹€à¸•à¹‡à¸¡ FB)"
      example: "Jutamat Fah N'Finn Sangprakai"
      status: âœ… linked
      note: >
        à¸„à¸™à¸—à¸µà¹ˆ FB à¸¡à¸­à¸šà¸«à¸¡à¸²à¸¢à¹ƒà¸«à¹‰à¸”à¸¹à¹à¸¥à¹à¸Šà¸— (auto-assign à¸«à¸£à¸·à¸­ manual claim)
        à¸•à¸­à¸™à¸™à¸µà¹‰à¸œà¸¹à¸à¸à¸±à¸š Employee.id à¸œà¹ˆà¸²à¸™ assignedEmployeeId FK à¹à¸¥à¹‰à¸§

    linked_to:
      - { target: customers, via: "customerId FK",  status: "âœ… linked" }
      - { target: messages,  via: "conversationId",  status: "âœ… linked" }
      - { target: episodes,  via: "conversationId",  status: "âœ… linked" }
      - { target: employees, via: "assignedEmployeeId FK", status: "âœ… linked" }
      # âŒ à¹„à¸¡à¹ˆà¸¡à¸µ FK à¹„à¸›à¸¢à¸±à¸‡ Order (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¹à¸Šà¸—à¸™à¸µà¹‰à¸™à¸³à¹„à¸›à¸ªà¸¹à¹ˆà¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¹„à¸«à¸™)
      # âŒ à¹„à¸¡à¹ˆà¸¡à¸µ FK à¹„à¸›à¸¢à¸±à¸‡ Campaign/Ad (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸¥à¸¹à¸à¸„à¹‰à¸²à¸¡à¸²à¸ˆà¸²à¸à¹‚à¸†à¸©à¸“à¸²à¹„à¸«à¸™)

  message:
    table: messages
    primary_id:
      field: messageId
      format: "msg_{customer_id}{timestamp}-{seq}"
      example: "msg_255708850559451731740821200000-1"
      source: "Generated during Business Suite Sync (REQ-06)"
      status: âœ… linked
      note: >
        ID à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸£à¸°à¸šà¸šà¸ªà¸£à¹‰à¸²à¸‡à¸‚à¸¶à¹‰à¸™à¹€à¸­à¸‡à¹€à¸à¸·à¹ˆà¸­à¸œà¸¹à¸à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ
        à¹ƒà¸Šà¹‰ PSID + Timestamp + Sequence à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰ unique à¹à¸¥à¸°à¸ªà¸·à¸šà¸„à¹‰à¸™à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸”à¹‰à¸‡à¹ˆà¸²à¸¢

    from_name:
      field: fromName
      format: "string"
      example: "Satabongkot Noinin"
      status: âœ… linked
      note: >
        à¸Šà¸·à¹ˆà¸­à¸„à¸™à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸ˆà¸£à¸´à¸‡ â€” à¸œà¸¹à¸à¸à¸±à¸š Employee.id à¸œà¹ˆà¸²à¸™ responderId FK
        à¸”à¸¶à¸‡à¸ˆà¸²à¸ "à¸ªà¹ˆà¸‡à¹‚à¸”à¸¢" à¹ƒà¸™ Business Suite à¸”à¹‰à¸§à¸¢ Playwright scraper

    from_id:
      field: fromId
      format: "string"
      example: "170707786504"
      status: âš ï¸ string
      note: "Graph API à¹ƒà¸«à¹‰à¹à¸„à¹ˆ Page ID â€” à¹„à¸¡à¹ˆà¸Šà¹ˆà¸§à¸¢ identify admin"

    fiber_msg_id:
      field: "(à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸à¹‡à¸š)"
      format: "mid.$cAABa1..."
      source: "Business Suite React Fiber"
      status: âŒ missing
      note: >
        Messenger internal format (Short ID) â€” **à¹„à¸¡à¹ˆ match** à¸à¸±à¸š Graph API format (m_AQJb...)
        à¸œà¸¥à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š (2026-03-01): ID à¸„à¸™à¸¥à¸°à¸Šà¸¸à¸”à¸à¸±à¸™à¹‚à¸”à¸¢à¸ªà¸´à¹‰à¸™à¹€à¸Šà¸´à¸‡ (App vs API) 
        à¸—à¸³à¹ƒà¸«à¹‰ Direct Match à¹ƒà¸™ Phase A à¸—à¸³à¹„à¸¡à¹ˆà¹„à¸”à¹‰ â€” à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰ Text Matching à¸•à¹ˆà¸­à¹„à¸›

    linked_to:
      - { target: conversations, via: "conversationId FK", status: "âœ… linked" }
      - { target: employees,    via: "responderId FK",    status: "âœ… linked" }

  chat_episode:
    table: chat_episodes
    primary_id:
      field: episodicId
      status: âœ… linked
      note: "session boundary à¸•à¸²à¸¡ timeout 30 à¸™à¸²à¸—à¸µ à¸«à¸£à¸·à¸­ ad ID à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™"

    linked_to:
      - { target: conversations, via: "conversationId FK", status: "âœ… linked" }

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 3. SALES â€” à¸à¸²à¸£à¸‚à¸²à¸¢, à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­, à¸˜à¸¸à¸£à¸à¸£à¸£à¸¡
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

sales:

  order:
    table: orders
    primary_id:
      field: orderId
      format: "string"
      status: âœ… linked

    linked_to:
      - { target: customers,    via: "customerId FK",    status: "âœ… linked" }
      - { target: transactions, via: "orderId FK",       status: "âœ… linked" }
      # âŒ à¹„à¸¡à¹ˆà¸¡à¸µ FK à¹„à¸›à¸¢à¸±à¸‡ Employee (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¹ƒà¸„à¸£à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢)
      # âŒ à¹„à¸¡à¹ˆà¸¡à¸µ FK à¹„à¸›à¸¢à¸±à¸‡ Conversation (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¸¡à¸²à¸ˆà¸²à¸à¹à¸Šà¸—à¹„à¸«à¸™)

  transaction:
    table: transactions
    primary_id:
      field: transactionId
      status: âœ… linked

    chat_message_id:
      field: chatMessageId
      status: âš ï¸ string
      note: "à¸­à¹‰à¸²à¸‡à¸–à¸¶à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸ªà¸¥à¸´à¸› â€” à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ FK à¸ˆà¸£à¸´à¸‡"

    linked_to:
      - { target: orders, via: "orderId FK", status: "âœ… linked" }

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 4. MARKETING â€” à¹à¸„à¸¡à¹€à¸›à¸à¹‚à¸†à¸©à¸“à¸²
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

marketing:

  campaign:
    table: campaigns
    primary_id:
      field: campaignId
      source: "Facebook Ads API"
      status: âœ… linked

    linked_to:
      - { target: ad_sets,    via: "campaignId FK", status: "âœ… linked" }
      - { target: ad_account, via: "adAccountId FK", status: "âœ… linked" }
      # âŒ à¹„à¸¡à¹ˆà¸¡à¸µ FK à¹„à¸›à¸¢à¸±à¸‡ Conversation (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸² campaign à¹„à¸«à¸™à¸™à¸³à¸¥à¸¹à¸à¸„à¹‰à¸²à¸¡à¸²à¸„à¸¸à¸¢)

  ad:
    table: ads
    primary_id:
      field: adId
      source: "Facebook Ads API"
      status: âœ… linked

    linked_to:
      - { target: ad_sets,        via: "adSetId FK",      status: "âœ… linked" }
      - { target: daily_metrics,  via: "adId FK",         status: "âœ… linked" }
      - { target: hourly_metrics, via: "adId FK",         status: "âœ… linked" }
      - { target: live_status,    via: "adId FK",         status: "âœ… linked" }
      - { target: creative,       via: "creativeId FK",   status: "âœ… linked" }
      - { target: experiment,     via: "experimentId FK", status: "âœ… linked" }

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 5. SUPPORT â€” à¸‡à¸²à¸™, à¸›à¸±à¸à¸«à¸², à¸•à¸´à¸”à¸•à¸²à¸¡
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

support:

  task:
    table: tasks
    primary_id:
      field: taskId
      status: âœ… linked

    linked_to:
      - { target: customers, via: "customerId FK",  status: "âœ… linked" }
      - { target: employees, via: "assigneeId FK",  status: "âœ… linked" }
      # âš ï¸ generic â€” à¹„à¸¡à¹ˆà¸¡à¸µ structured ticket fields (resolution time, category, SLA)

  timeline_event:
    table: timeline_events
    primary_id:
      field: eventId
      status: âœ… linked
      note: "audit trail à¸‚à¸­à¸‡à¸¥à¸¹à¸à¸„à¹‰à¸²"

    linked_to:
      - { target: customers, via: "customerId FK", status: "âœ… linked" }

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 6. SYNC â€” à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Facebook Business Suite Scraper
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

sync:

  synced_threads:
    storage: "cache/synced_threads.json (local file, à¹„à¸¡à¹ˆà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ DB)"
    primary_id:
      field: "threadID (PSID)"
      format: "numeric string"
      example: "100002428547834"
      status: âœ… linked
      note: "Persistence cache â€” à¸›à¹‰à¸­à¸‡à¸à¸±à¸™ sync à¸‹à¹‰à¸³"

    data_stored:
      - syncedAt: "ISO timestamp"
      - status: "success | failed"
      - agents: "string[] â€” à¸Šà¸·à¹ˆà¸­ admin à¸—à¸µà¹ˆà¸à¸š"

    linked_to:
      - { target: "conversation.participantId", via: "text match (PSID)", status: "âš ï¸ string" }
      # âŒ à¹„à¸¡à¹ˆà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ DB â€” à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ JSON file à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™

# ============================================================================
# 7. âŒ à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸à¸´à¹ˆà¸¡ â€” à¹€à¸£à¸µà¸¢à¸‡à¸•à¸²à¸¡à¸„à¸§à¸²à¸¡à¸ªà¸³à¸„à¸±à¸
# ============================================================================

required_additions:

  # â”€â”€â”€ Priority 1: Agent Attribution (KPI & à¸„à¹ˆà¸²à¸„à¸­à¸¡) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-01"
    name: "Message â†’ Employee FK"
    priority: "ğŸ”´ Critical"
    status: "âœ… linked"
    reason: >
      à¸•à¸­à¸™à¸™à¸µà¹‰ Message.fromName à¹€à¸›à¹‡à¸™à¹à¸„à¹ˆ string "Satabongkot Noinin"
      à¸•à¹‰à¸­à¸‡ fuzzy match à¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¸„à¸³à¸™à¸§à¸“ KPI â€” à¸Šà¹‰à¸²à¹à¸¥à¸°à¸­à¸²à¸ˆà¸à¸¥à¸²à¸”
    current: "Message.responderId (FK)"
    impact:
      - "TeamKPI query à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸ fuzzy match â†’ direct JOIN"
      - "Commission à¸„à¸³à¸™à¸§à¸“à¹„à¸”à¹‰à¹à¸¡à¹ˆà¸™à¸¢à¸³ 100%"

  - id: "REQ-02"
    name: "Conversation â†’ Employee FK (assignedAgentId)"
    priority: "ğŸ”´ Critical"
    status: "âœ… linked"
    reason: >
      assignedAgent à¹€à¸›à¹‡à¸™ string â€” à¹ƒà¸Šà¹‰à¹à¸¢à¸ "à¸„à¸™à¸—à¸µà¹ˆ FB à¸¡à¸­à¸šà¸«à¸¡à¸²à¸¢" vs "à¸„à¸™à¸—à¸µà¹ˆà¸•à¸­à¸šà¸ˆà¸£à¸´à¸‡"
    current: "Conversation.assignedEmployeeId (FK)"

  # â”€â”€â”€ Priority 2: Sales Attribution (à¹ƒà¸„à¸£à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-03"
    name: "Order â†’ Employee FK (closedById)"
    priority: "ğŸ”´ Critical"
    reason: >
      à¸•à¸­à¸™à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¹€à¸¥à¸¢à¸§à¹ˆà¸²à¹ƒà¸„à¸£à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢ â€” à¹à¸šà¹ˆà¸‡à¸„à¹ˆà¸²à¸„à¸­à¸¡à¹„à¸¡à¹ˆà¹„à¸”à¹‰
    current: "à¹„à¸¡à¹ˆà¸¡à¸µ field"
    proposed:
      add_field: "Order.closedById â†’ Employee.id (FK, nullable)"
      migration: >
        1. à¹€à¸à¸´à¹ˆà¸¡ closedById à¹ƒà¸™ Order model
        2. Backfill: à¸”à¸¹à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢à¸à¹ˆà¸­à¸™ order date à¸—à¸µà¹ˆ admin à¸ªà¹ˆà¸‡ â†’ resolve Employee
    impact:
      - "à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¹ƒà¸„à¸£à¸›à¸´à¸”à¸”à¸µà¸¥ â†’ à¹à¸šà¹ˆà¸‡à¸„à¹ˆà¸²à¸„à¸­à¸¡à¹„à¸”à¹‰"
      - "à¸§à¸±à¸” conversion rate per agent à¹„à¸”à¹‰à¸ˆà¸£à¸´à¸‡"

  - id: "REQ-04"
    name: "Order â†’ Conversation FK"
    priority: "ğŸŸ¡ High"
    reason: >
      à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¸¡à¸²à¸ˆà¸²à¸à¹à¸Šà¸—à¹„à¸«à¸™ â€” à¸§à¸±à¸” attribution chain à¹„à¸¡à¹ˆà¹„à¸”à¹‰
    current: "à¹„à¸¡à¹ˆà¸¡à¸µ field"
    proposed:
      add_field: "Order.conversationId â†’ Conversation.id (FK, nullable)"
      note: "à¸œà¸¹à¸ order à¸à¸±à¸šà¹à¸Šà¸—à¸—à¸µà¹ˆà¸™à¸³à¹„à¸›à¸ªà¸¹à¹ˆà¸à¸²à¸£à¸‹à¸·à¹‰à¸­"

  # â”€â”€â”€ Priority 3: Funnel Tracking (à¸¥à¸¹à¸à¸„à¹‰à¸²à¸«à¸²à¸¢à¸•à¸£à¸‡à¹„à¸«à¸™) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-05"
    name: "FunnelStageLog (model à¹ƒà¸«à¸¡à¹ˆ)"
    priority: "ğŸŸ¡ High"
    reason: >
      Customer.lifecycleStage à¸¡à¸µà¹à¸„à¹ˆà¸ªà¸–à¸²à¸™à¸°à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ à¹„à¸¡à¹ˆà¸¡à¸µà¸›à¸£à¸°à¸§à¸±à¸•à¸´
      à¸•à¹‰à¸­à¸‡à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸¥à¸¹à¸à¸„à¹‰à¸²à¸«à¸²à¸¢à¹„à¸›à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¹„à¸«à¸™à¸¡à¸²à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸”
    current: "Customer.lifecycleStage = string (à¸„à¹ˆà¸²à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸”à¸µà¸¢à¸§)"
    proposed:
      new_model: "FunnelStageLog"
      fields:
        - "id: cuid"
        - "customerId â†’ Customer.id (FK)"
        - "fromStage: string (Lead, Prospect, Negotiation, Won, Lost)"
        - "toStage: string"
        - "changedById â†’ Employee.id (FK, nullable) â€” à¹ƒà¸„à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ªà¸–à¸²à¸™à¸°"
        - "reason: string? (à¹€à¸Šà¹ˆà¸™ 'à¸£à¸²à¸„à¸²à¹à¸à¸‡', 'à¹„à¸¡à¹ˆà¸•à¸­à¸š 7 à¸§à¸±à¸™')"
        - "changedAt: DateTime"
      stages:
        - "Lead â†’ à¹€à¸‚à¹‰à¸²à¸¡à¸²à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸ (à¸ˆà¸²à¸ ad à¸«à¸£à¸·à¸­ organic)"
        - "Engaged â†’ à¸•à¸­à¸šà¹à¸Šà¸— / à¸–à¸²à¸¡à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”"
        - "Prospect â†’ à¸ªà¸™à¹ƒà¸ˆà¸ˆà¸£à¸´à¸‡ / à¸‚à¸­à¸£à¸²à¸„à¸²"
        - "Negotiation â†’ à¸•à¹ˆà¸­à¸£à¸­à¸‡ / à¹€à¸¥à¸·à¸­à¸ package"
        - "Payment â†’ à¸£à¸­à¸ˆà¹ˆà¸²à¸¢à¹€à¸‡à¸´à¸™ / à¸ªà¹ˆà¸‡à¸ªà¸¥à¸´à¸›"
        - "Won â†’ à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢ à¸ªà¸³à¹€à¸£à¹‡à¸ˆ"
        - "Lost â†’ à¸«à¸²à¸¢à¹„à¸› / à¸›à¸à¸´à¹€à¸ªà¸˜"
      impact:
        - "à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ drop-off: à¸¥à¸¹à¸à¸„à¹‰à¸²à¸«à¸²à¸¢à¸¡à¸²à¸à¸ªà¸¸à¸”à¸•à¸£à¸‡ Payment â†’ à¸­à¸²à¸ˆà¹à¸›à¸¥à¸§à¹ˆà¸²à¸ˆà¹ˆà¸²à¸¢à¸¢à¸²à¸"
        - "à¸§à¸±à¸” conversion rate per stage per agent"
        - "à¸”à¸¹ average time per stage"

  # â”€â”€â”€ Priority 4: Ticket / Support â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-06"
    name: "Ticket fields à¸šà¸™ Task (à¸«à¸£à¸·à¸­ model à¹ƒà¸«à¸¡à¹ˆ)"
    priority: "ğŸŸ¡ High"
    reason: >
      Task à¸¡à¸µà¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§à¹à¸•à¹ˆà¹€à¸›à¹‡à¸™ generic â€” à¹„à¸¡à¹ˆà¸¡à¸µ category, resolution time, SLA
      à¸•à¹‰à¸­à¸‡à¸§à¸±à¸”à¸§à¹ˆà¸² admin à¹„à¸«à¸™à¹à¸à¹‰à¸›à¸±à¸à¸«à¸²à¸¥à¸¹à¸à¸„à¹‰à¸²à¹€à¸£à¹‡à¸§/à¸Šà¹‰à¸²
    current: "Task model â€” generic fields à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™"
    proposed:
      option_a: "à¹€à¸à¸´à¹ˆà¸¡ fields à¸šà¸™ Task model à¹€à¸”à¸´à¸¡"
      option_b: "à¸ªà¸£à¹‰à¸²à¸‡ Ticket model à¹ƒà¸«à¸¡à¹ˆà¹à¸¢à¸à¸ˆà¸²à¸ Task"
      recommended: "option_a (à¹€à¸à¸´à¹ˆà¸¡à¸šà¸™ Task)"
      add_fields:
        - "category: string (inquiry, complaint, discount_request, schedule_change, refund)"
        - "resolvedAt: DateTime?"
        - "resolvedById â†’ Employee.id (FK, nullable)"
        - "resolutionTimeMinutes: Int? (à¸„à¸³à¸™à¸§à¸“à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)"
        - "satisfaction: Int? (1-5 rating)"
        - "slaDeadline: DateTime?"
        - "slaMet: Boolean?"
      impact:
        - "à¸§à¸±à¸” avg resolution time per agent"
        - "à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸›à¸±à¸à¸«à¸²à¸›à¸£à¸°à¹€à¸ à¸—à¹„à¸«à¸™à¹€à¸à¸´à¸”à¸šà¹ˆà¸­à¸¢"
        - "SLA tracking â€” à¸•à¸­à¸šà¸¥à¸¹à¸à¸„à¹‰à¸²à¸—à¸±à¸™à¹€à¸§à¸¥à¸²à¹„à¸«à¸¡"

  # â”€â”€â”€ Priority 5: Marketing â†’ Conversation Attribution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-07"
    name: "Conversation â†’ Ad FK (firstTouchAdId)"
    priority: "ğŸŸ¢ Medium"
    reason: >
      à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸¥à¸¹à¸à¸„à¹‰à¸²à¸¡à¸²à¸ˆà¸²à¸à¹‚à¸†à¸©à¸“à¸²à¹„à¸«à¸™ â†’ à¸§à¸±à¸” ROAS à¸ˆà¸£à¸´à¸‡ per agent
    current: "à¸¡à¸µà¹à¸„à¹ˆ session boundary logic (ad ID à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ = session à¹ƒà¸«à¸¡à¹ˆ) à¹à¸•à¹ˆà¹„à¸¡à¹ˆ persist"
    proposed:
      add_field: "Conversation.firstTouchAdId â†’ Ad.id (FK, nullable)"
      note: "à¸”à¸¶à¸‡à¸ˆà¸²à¸ referral data à¸•à¸­à¸™ webhook à¸£à¸±à¸š first message"
    impact:
      - "Full attribution chain: Ad â†’ Conversation â†’ Agent â†’ Order â†’ Revenue"
      - "à¸§à¸±à¸” ROAS per agent per campaign"

  # â”€â”€â”€ Priority 6: Agent Performance Metrics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-08"
    name: "First Response Time tracking"
    priority: "ğŸŸ¢ Medium"
    reason: >
      à¸§à¸±à¸”à¸§à¹ˆà¸² agent à¸•à¸­à¸šà¸¥à¸¹à¸à¸„à¹‰à¸²à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸à¹€à¸£à¹‡à¸§à¹à¸„à¹ˆà¹„à¸«à¸™ (SLA)
    current: "à¸¡à¸µ Message.createdAt à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¸¡à¸µ logic à¸„à¸³à¸™à¸§à¸“"
    proposed:
      add_fields:
        - "Conversation.firstResponseAt: DateTime?"
        - "Conversation.firstResponseTimeSeconds: Int?"
      note: "à¸„à¸³à¸™à¸§à¸“à¸ˆà¸²à¸ first customer message â†’ first admin message"

  - id: "REQ-09"
    name: "Handoff Log"
    priority: "ğŸŸ¢ Medium"
    reason: >
      à¸¥à¸¹à¸à¸„à¹‰à¸²à¸–à¸¹à¸à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¸à¸µà¹ˆà¸„à¸£à¸±à¹‰à¸‡ à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ agent à¹„à¸«à¸™à¸šà¹‰à¸²à¸‡
    current: "à¹„à¸¡à¹ˆà¸¡à¸µ â€” assignedAgent à¹€à¸‚à¸µà¸¢à¸™à¸—à¸±à¸šà¸„à¹ˆà¸²à¹€à¸”à¸´à¸¡"
    proposed:
      new_model: "AgentHandoff"
      fields:
        - "id: cuid"
        - "conversationId â†’ Conversation.id (FK)"
        - "fromAgentId â†’ Employee.id (FK, nullable)"
        - "toAgentId â†’ Employee.id (FK)"
        - "reason: string?"
        - "handoffAt: DateTime"

  - id: "REQ-10"
    name: "Commission Rule Engine"
    priority: "ğŸŸ¢ Medium"
    reason: >
      à¸à¸à¹à¸šà¹ˆà¸‡à¸„à¹ˆà¸²à¸„à¸­à¸¡ à¹€à¸Šà¹ˆà¸™ 100% à¸–à¹‰à¸²à¸„à¸™à¹€à¸”à¸µà¸¢à¸§à¸›à¸´à¸”, split à¸–à¹‰à¸²à¸«à¸¥à¸²à¸¢à¸„à¸™à¸”à¸¹à¹à¸¥
    current: "à¹„à¸¡à¹ˆà¸¡à¸µ"
    proposed:
      new_model: "CommissionRule"
      fields:
        - "id: cuid"
        - "name: string (à¹€à¸Šà¹ˆà¸™ 'Solo Close 100%', 'Assist 30/70')"
        - "type: string (solo, split, assist)"
        - "closerPercent: Float"
        - "assisterPercent: Float"
        - "isDefault: Boolean"

      new_model_2: "CommissionEntry"
      fields:
        - "id: cuid"
        - "orderId â†’ Order.id (FK)"
        - "employeeId â†’ Employee.id (FK)"
        - "role: string (closer, assister, assigned)"
        - "percent: Float"
        - "amount: Float"
        - "ruleId â†’ CommissionRule.id (FK)"
        - "createdAt: DateTime"

  # â”€â”€â”€ Priority 7: Customer Satisfaction â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - id: "REQ-11"
    name: "Customer Satisfaction / Feedback"
    priority: "ğŸ”² Proposed"
    reason: "à¸§à¸±à¸”à¸„à¸§à¸²à¸¡à¸à¸¶à¸‡à¸à¸­à¹ƒà¸ˆà¸¥à¸¹à¸à¸„à¹‰à¸²à¸«à¸¥à¸±à¸‡à¸ˆà¸šà¹à¸Šà¸—à¸«à¸£à¸·à¸­à¸«à¸¥à¸±à¸‡à¹€à¸£à¸µà¸¢à¸™"
    proposed:
      new_model: "Feedback"
      fields:
        - "id: cuid"
        - "customerId â†’ Customer.id (FK)"
        - "conversationId â†’ Conversation.id (FK, nullable)"
        - "orderId â†’ Order.id (FK, nullable)"
        - "rating: Int (1-5)"
        - "comment: String?"
        - "type: string (chat, course, general)"
        - "createdAt: DateTime"

# ============================================================================
# 8. RELATIONSHIP DIAGRAM (text-based)
# ============================================================================
#
#  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#  â”‚ Campaign â”‚â”€â”€â”€â”€â”€â”€>â”‚    AdSet      â”‚â”€â”€â”€â”€â”€â”€>â”‚   Ad    â”‚
#  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
#                                                  â”‚ âŒ firstTouchAdId (REQ-07)
#                                                  â–¼
#  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  customerId FK  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  convId FK  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#  â”‚ Customer â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Conversation  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Message â”‚
#  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
#       â”‚                             â”‚                          â”‚
#       â”‚                    âš ï¸ assignedAgent (string)    âš ï¸ fromName (string)
#       â”‚                    âŒ assignedAgentId (REQ-02)  âŒ responderId (REQ-01)
#       â”‚                             â”‚                          â”‚
#       â”‚                             â–¼                          â–¼
#       â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#       â”‚                      â”‚ Employee â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Employee â”‚
#       â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#       â”‚
#       â”‚  customerId FK  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  orderId FK  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Order  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Transaction â”‚
#                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#                              â”‚
#                     âŒ closedById (REQ-03)
#                     âŒ conversationId (REQ-04)
#                              â”‚
#                              â–¼
#                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#                       â”‚ Employee â”‚
#                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
#  âŒ New Models Needed:
#  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#  â”‚ FunnelStageLog  â”‚  â”‚ AgentHandoff â”‚  â”‚ CommissionEntry â”‚
#  â”‚ (REQ-05)        â”‚  â”‚ (REQ-09)     â”‚  â”‚ (REQ-10)        â”‚
#  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ============================================================================

# ============================================================================
# 9. AI_CONTEXT â€” AI Chat Bar per Page
# ============================================================================
# à¹à¸•à¹ˆà¸¥à¸°à¸«à¸™à¹‰à¸²à¹ƒà¸™ CRM à¸¡à¸µ AI chat bar (BusinessAnalyst.js / Gemini)
# à¹‚à¸«à¸¥à¸” context à¹€à¸‰à¸à¸²à¸°à¸‚à¸­à¸‡à¸«à¸™à¹‰à¸²à¸™à¸±à¹‰à¸™ + à¸œà¸¹à¸à¸à¸±à¸š Employee.id à¸‚à¸­à¸‡ admin à¸—à¸µà¹ˆ login à¹€à¸ªà¸¡à¸­
#
# â”€â”€â”€ 2 à¹à¸™à¸§à¸„à¸´à¸”à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹à¸¢à¸à¸à¸±à¸™ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#
# 1. page_data_filtered_by_employee
#    Data à¸—à¸µà¹ˆà¹à¸ªà¸”à¸‡à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸–à¸¹à¸ filter à¹€à¸à¸·à¹ˆà¸­à¹à¸ªà¸”à¸‡à¸‚à¸­à¸‡ agent à¸„à¸™à¸™à¸±à¹‰à¸™à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
#    false = à¹à¸ªà¸”à¸‡à¸ à¸²à¸à¸£à¸§à¸¡ (Dashboard, Analytics, FacebookAds)
#    true  = à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡ agent à¸«à¸£à¸·à¸­ customer à¸„à¸™à¸™à¸±à¹‰à¸™ (TeamKPI, Chat, CustomerCard)
#
# 2. ai_chat_uses_employee_identity
#    AI Chat Bar à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸à¸³à¸¥à¸±à¸‡à¸„à¸¸à¸¢à¸à¸±à¸šà¹ƒà¸„à¸£à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ â€” à¸•à¸­à¸š YES à¹€à¸ªà¸¡à¸­ (à¸—à¸¸à¸à¸«à¸™à¹‰à¸²)
#    à¹€à¸«à¸•à¸¸à¸œà¸¥: AI à¸•à¹‰à¸­à¸‡à¸£à¸¹à¹‰ Role (à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ vs admin), Memory à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§, Tone à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡
#
# Rule: page_data_filtered_by_employee à¸­à¸²à¸ˆà¹€à¸›à¹‡à¸™ false
#       à¹à¸•à¹ˆ ai_chat_uses_employee_identity = true à¹€à¸ªà¸¡à¸­ à¸—à¸¸à¸à¸«à¸™à¹‰à¸²
#
# Identity anchor:
#   currentEmployee.id â†’ FK à¸—à¸¸à¸à¸•à¸±à¸§: responderId, assignedAgentId, closedById
# ============================================================================

ai_context:

  shared:
    session_identity:
      field: "currentEmployee.id"
      type: "Employee.id (FK)"
      note: >
        Admin à¸—à¸µà¹ˆ login à¸­à¸¢à¸¹à¹ˆ = Employee record
        à¹ƒà¸Šà¹‰à¹€à¸›à¹‡à¸™ anchor à¹‚à¸«à¸¥à¸” memory à¹à¸¥à¸° context à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸‚à¸­à¸‡ agent à¸„à¸™à¸™à¸±à¹‰à¸™
        à¸—à¸¸à¸à¸«à¸™à¹‰à¸²à¸ªà¹ˆà¸‡ employeeId à¹€à¸‚à¹‰à¸² AI à¹€à¸à¸·à¹ˆà¸­ filter à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¹‰à¸•à¸£à¸‡

    memory_store:
      location: "Customer.intelligence (Json) â€” per customer"
      agent_memory: "Employee.performance (Json) â€” per agent"
      note: "AI à¸ªà¸²à¸¡à¸²à¸£à¸–à¸­à¹ˆà¸²à¸™à¹à¸¥à¸°à¹€à¸‚à¸µà¸¢à¸™ memory à¸à¸¥à¸±à¸šà¸¡à¸²à¹€à¸à¸·à¹ˆà¸­ persistent context à¸‚à¹‰à¸²à¸¡ session"

  pages:

    # â”€â”€ Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "Dashboard"
      component: "Dashboard.js"
      ai_function: "generateExecutiveReport() + chat()"
      context_loaded:
        - "totalRevenue, totalAdSpend, ROAS (à¸ à¸²à¸à¸£à¸§à¸¡à¸—à¸±à¹‰à¸‡à¸šà¸£à¸´à¸©à¸±à¸—)"
        - "bestSellers, activeCampaigns"
        - "customerCount, churnRate"

      # â”€â”€ 2 à¹à¸™à¸§à¸„à¸´à¸”à¸—à¸µà¹ˆà¸•à¹ˆà¸²à¸‡à¸à¸±à¸™ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      page_data_filtered_by_employee: false
      note_data: >
        Data à¸—à¸µà¹ˆà¹à¸ªà¸”à¸‡à¹ƒà¸™à¸«à¸™à¹‰à¸² = à¸ à¸²à¸à¸£à¸§à¸¡à¸˜à¸¸à¸£à¸à¸´à¸ˆà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” à¹„à¸¡à¹ˆ filter per agent
        à¹€à¸à¸£à¸²à¸° Dashboard = business overview (revenue à¸£à¸§à¸¡, ROAS à¸£à¸§à¸¡)
        à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ view à¸‚à¸­à¸‡ agent à¸„à¸™à¹€à¸”à¸µà¸¢à¸§ â€” à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¹à¸¥à¹‰à¸§

      ai_chat_uses_employee_identity: true
      employee_id_field: "currentEmployee.id"
      note_ai: >
        AI Chat Bar à¸•à¹‰à¸­à¸‡à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸à¸³à¸¥à¸±à¸‡à¸„à¸¸à¸¢à¸à¸±à¸šà¹ƒà¸„à¸£ à¹à¸¡à¹‰à¸§à¹ˆà¸² data à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸ à¸²à¸à¸£à¸§à¸¡
        à¹€à¸«à¸•à¸¸à¸œà¸¥:
          1. Tone â€” à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ (Boss) à¹€à¸«à¹‡à¸™ strategic detail + budget recommendations
                    Admin à¸—à¸±à¹ˆà¸§à¹„à¸› à¹€à¸«à¹‡à¸™ operational summary à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
          2. Memory â€” AI à¸ˆà¸³ context à¸‚à¹‰à¸²à¸¡ session à¸œà¹ˆà¸²à¸™ Employee.performance Json
          3. Role-based answer â€” "à¸„à¸§à¸£à¸«à¸¢à¸¸à¸” ad à¹„à¸«à¸™?" â†’ Boss = à¹à¸™à¸°à¸™à¸³à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œ,
                                                        Admin = à¹à¸„à¹ˆà¸šà¸­à¸ data
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      ai_questions_example:
        - "à¹à¸„à¸¡à¹€à¸›à¸à¹„à¸«à¸™ ROAS à¸•à¹ˆà¸³à¸ªà¸¸à¸”à¸•à¸­à¸™à¸™à¸µà¹‰"
        - "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸à¸¥à¸¸à¹ˆà¸¡à¹„à¸«à¸™à¸„à¸§à¸£ follow-up à¸à¹ˆà¸­à¸™"
        - "à¸ªà¸£à¸¸à¸›à¸ à¸²à¸à¸£à¸§à¸¡à¸˜à¸¸à¸£à¸à¸´à¸ˆà¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸™à¸µà¹‰à¹ƒà¸«à¹‰à¸«à¸™à¹ˆà¸­à¸¢"

    # â”€â”€ Analytics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "Analytics"
      component: "Analytics.js"
      ai_function: "chat() with campaign + funnel context"
      context_loaded:
        - "Campaign â†’ AdSet â†’ Ad metrics"
        - "FunnelStageLog (drop-off per stage)"
        - "Lead source breakdown"
        - "Conversion rate per stage"
      page_data_filtered_by_employee: false
      note_data: "Marketing analytics â€” à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸§à¸¡à¸—à¸±à¹‰à¸‡à¸£à¸°à¸šà¸š à¹„à¸¡à¹ˆ filter per agent à¹à¸•à¹ˆà¸„à¸§à¸£à¸¡à¸µ breakdown"
      ai_chat_uses_employee_identity: true
      employee_id_field: "currentEmployee.id"
      note_ai: "AI à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸«à¸£à¸·à¸­ admin â†’ à¸›à¸£à¸±à¸š depth à¸‚à¸­à¸‡ recommendation"
      missing_context:
        - "âŒ FunnelStageLog à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¹ƒà¸™ DB (REQ-05)"
        - "âŒ Ad â†’ Conversation FK à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ (REQ-07)"
      ai_questions_example:
        - "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸«à¸²à¸¢à¹„à¸›à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¹„à¸«à¸™à¸¡à¸²à¸à¸ªà¸¸à¸”"
        - "à¹à¸„à¸¡à¹€à¸›à¸ Ramen à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢à¹„à¸”à¹‰à¸à¸µà¹ˆà¹€à¸›à¸­à¸£à¹Œà¹€à¸‹à¸™à¸•à¹Œ"

    # â”€â”€ Team KPI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "TeamKPI"
      component: "TeamKPI.js"
      ai_function: "chat() with per-agent stats context"
      context_loaded:
        - "Employee[] â€” à¸—à¸¸à¸ agent à¸—à¸µà¹ˆ active"
        - "revenue per agent (à¸ˆà¸²à¸ Order.closedById)"
        - "leads per agent (à¸ˆà¸²à¸ Message.responderId)"
        - "conversion rate per agent"
        - "avg response time per agent"
        - "commission breakdown"
      employee_id_used: true
      employee_id_field: "Employee.id"
      current_gap: >
        à¸•à¸­à¸™à¸™à¸µà¹‰à¹ƒà¸Šà¹‰ fuzzy string match à¸Šà¸·à¹ˆà¸­ â†’ revenue/leads à¸™à¸±à¸šà¹„à¸¡à¹ˆà¸„à¸£à¸š
        à¹€à¸¡à¸·à¹ˆà¸­ REQ-01, 02, 03 à¹€à¸ªà¸£à¹‡à¸ˆ: JOIN à¸•à¸£à¸‡à¸œà¹ˆà¸²à¸™ Employee.id à¹„à¸”à¹‰à¹€à¸¥à¸¢
      ai_questions_example:
        - "à¹ƒà¸„à¸£à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢à¹„à¸”à¹‰à¸¡à¸²à¸à¸ªà¸¸à¸”à¹€à¸”à¸·à¸­à¸™à¸™à¸µà¹‰"
        - "Fah à¸”à¸¹à¹à¸¥à¸¥à¸¹à¸à¸„à¹‰à¸²à¸­à¸¢à¸¹à¹ˆà¸à¸µà¹ˆà¸„à¸™à¸—à¸µà¹ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸›à¸´à¸”"
        - "à¹à¸šà¹ˆà¸‡à¸„à¹ˆà¸²à¸„à¸­à¸¡à¹€à¸”à¸·à¸­à¸™à¸™à¸µà¹‰à¹„à¸”à¹‰à¹€à¸—à¹ˆà¸²à¹„à¸«à¸£à¹ˆ"

    # â”€â”€ Facebook Chat (Inbox) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "FacebookChat"
      component: "FacebookChat.js"
      ai_function: >
        detectAgentFromChat() + suggestProactiveTasks() +
        suggestLabels() + generateSmartReply() + extractProductsFromChat()
      context_loaded:
        - "Conversation.messages[] â€” à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¹à¸Šà¸—à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™"
        - "Customer profile + lifecycleStage"
        - "Customer.intelligence (AI memory à¸ˆà¸²à¸à¹à¸Šà¸—à¸à¹ˆà¸­à¸™)"
        - "Employee list (staffList à¸ªà¸³à¸«à¸£à¸±à¸š agent detection)"
        - "Product catalog (à¸ªà¸³à¸«à¸£à¸±à¸š product extraction)"
      employee_id_used: true
      employee_id_field: "Message.responderId â†’ Employee.id"
      note: >
        à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰à¹ƒà¸Šà¹‰ AI à¸¡à¸²à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸” â€” real-time per message
        Smart reply à¸ªà¹ˆà¸‡à¹ƒà¸™à¸™à¸²à¸¡ Persona à¸‚à¸­à¸‡ agent à¸—à¸µà¹ˆ login
      ai_questions_example:
        - "à¸ªà¸£à¸¸à¸›à¹à¸Šà¸—à¸™à¸µà¹‰à¹ƒà¸«à¹‰à¸«à¸™à¹ˆà¸­à¸¢"
        - "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸„à¸™à¸™à¸µà¹‰à¸ªà¸™à¹ƒà¸ˆà¸„à¸­à¸£à¹Œà¸ªà¹„à¸«à¸™"
        - "à¸£à¹ˆà¸²à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸•à¸­à¸šà¹€à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸„à¸²à¹ƒà¸«à¹‰à¸«à¸™à¹ˆà¸­à¸¢"

    # â”€â”€ Facebook Ads â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "FacebookAds"
      component: "FacebookAds.js"
      ai_function: "chat() with ads performance context"
      context_loaded:
        - "Campaign/AdSet/Ad metrics (spend, ROAS, CTR, CPC)"
        - "Health score per ad"
        - "Creative fatigue detection (>30 days)"
        - "Daily/Hourly metrics"
      page_data_filtered_by_employee: false
      note_data: "Pure marketing data â€” ad performance à¹„à¸¡à¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸š agent à¸„à¸™à¹„à¸«à¸™"
      ai_chat_uses_employee_identity: true
      employee_id_field: "currentEmployee.id"
      note_ai: "AI à¸£à¸¹à¹‰à¸•à¸±à¸§à¸•à¸™ à¹€à¸à¸·à¹ˆà¸­ persist memory à¹à¸¥à¸°à¸›à¸£à¸±à¸š tone (à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ vs admin)"
      ai_questions_example:
        - "Ad à¹„à¸«à¸™à¸„à¸§à¸£à¸›à¸´à¸”à¸à¹ˆà¸­à¸™à¹€à¸à¸£à¸²à¸° ROAS à¸•à¹ˆà¸³"
        - "Budget à¸„à¸§à¸£à¸¢à¹‰à¸²à¸¢à¹„à¸› campaign à¹„à¸«à¸™"

    # â”€â”€ Customer List / Profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "CustomerList / CustomerCard"
      component: "CustomerList.js"
      ai_function: "chat() with individual customer context"
      context_loaded:
        - "Customer profile, tier, lifecycle stage"
        - "Order history + revenue"
        - "Conversation history (via Message.responderId)"
        - "Agent à¸—à¸µà¹ˆà¸”à¸¹à¹à¸¥ (Conversation.assignedAgentId â†’ Employee)"
        - "Tasks à¸—à¸µà¹ˆà¸„à¹‰à¸²à¸‡à¸­à¸¢à¸¹à¹ˆ"
        - "Customer.intelligence (AI memory)"
      employee_id_used: true
      employee_id_field: "Conversation.assignedAgentId â†’ Employee.id"
      ai_questions_example:
        - "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸„à¸™à¸™à¸µà¹‰à¸™à¹ˆà¸²à¸ˆà¸°à¸‹à¸·à¹‰à¸­à¸­à¸°à¹„à¸£à¸•à¹ˆà¸­"
        - "à¹ƒà¸„à¸£à¸”à¸¹à¹à¸¥à¸¥à¸¹à¸à¸„à¹‰à¸²à¸„à¸™à¸™à¸µà¹‰à¸­à¸¢à¸¹à¹ˆ"
        - "à¸ªà¸£à¸¸à¸› interaction à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸‚à¸­à¸‡à¸¥à¸¹à¸à¸„à¹‰à¸²à¸„à¸™à¸™à¸µà¹‰"

    # â”€â”€ Employee Management â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    - page: "EmployeeManagement"
      component: "EmployeeManagement.js"
      ai_function: "chat() with HR + performance context"
      context_loaded:
        - "Employee list + roles + status"
        - "performance Json per employee"
        - "Task completion rate per employee"
        - "Revenue / leads per employee (à¸ˆà¸²à¸ REQ-01,02,03)"
      employee_id_used: true
      employee_id_field: "Employee.id (primary)"
      ai_questions_example:
        - "à¹ƒà¸„à¸£à¸¡à¸µ workload à¹€à¸¢à¸­à¸°à¸ªà¸¸à¸”à¸•à¸­à¸™à¸™à¸µà¹‰"
        - "à¸à¸™à¸±à¸à¸‡à¸²à¸™à¸„à¸™à¹„à¸«à¸™ response time à¸Šà¹‰à¸²à¸ªà¸¸à¸”"

# â”€â”€â”€ Context Loading Pattern â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# à¹à¸•à¹ˆà¸¥à¸°à¸«à¸™à¹‰à¸²à¸ªà¹ˆà¸‡ context à¹€à¸‚à¹‰à¸² BusinessAnalyst.chat() à¹ƒà¸™à¸£à¸¹à¸›à¹à¸šà¸š:
#
#  {
#    page: "TeamKPI",
#    currentEmployeeId: "emp_xxx",          â† admin à¸—à¸µà¹ˆ login
#    viewingEmployeeId: "emp_yyy",           â† agent à¸—à¸µà¹ˆà¸à¸³à¸¥à¸±à¸‡à¸”à¸¹à¸­à¸¢à¸¹à¹ˆ (à¸–à¹‰à¸²à¸¡à¸µ)
#    data: { ...page-specific stats },
#    memory: employee.performance,           â† persistent memory à¸‚à¹‰à¸²à¸¡ session
#  }
#
# AI à¹ƒà¸Šà¹‰ employeeId à¹€à¸à¸·à¹ˆà¸­:
#  1. Filter à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¹‰à¸•à¸£à¸‡à¸à¸±à¸š agent à¸„à¸™à¸™à¸±à¹‰à¸™
#  2. à¹‚à¸«à¸¥à¸”/à¸šà¸±à¸™à¸—à¸¶à¸ memory à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸‚à¸­à¸‡ agent
#  3. à¸›à¸£à¸±à¸š tone à¸à¸²à¸£à¸•à¸­à¸š (à¸„à¸¸à¸¢à¸à¸±à¸šà¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ vs à¸„à¸¸à¸¢à¸à¸±à¸š admin à¸—à¸±à¹ˆà¸§à¹„à¸›)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
